#!/usr/bin/env python
from os import listdir, statvfs

lines = []

for p in listdir('/proc'):
	try: p = int(p)
	except: continue

	name = open('/proc/%d/comm' % p).read().rstrip('\n')
	n = 0
	with open('/proc/%d/smaps' % p) as f:
		for line in f:
			line = line.split()
			if line[0] in ('Pss:', 'SwapPss:'):
				n += int(line[1])
	lines.append((n, '% 6d %s' % (p, name)))

lines.sort()
for n, name in lines:
	print('%8.1f %s' % (n/1024, name))
